-- ================================ --
--  EXECUTOR MEGA ADMIN MENU
-- ================================ --

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local VirtualUser = game:GetService("VirtualUser")
local TeleportService = game:GetService("TeleportService")
local Lighting = game:GetService("Lighting")

-- ================================ --
-- RAYFIELD + KEY SYSTEM (RICHTIG)
-- ================================ --

local Rayfield = loadstring(game:HttpGet(
	"https://raw.githubusercontent.com/SiriusSoftwareLtd/Rayfield/main/source.lua"
))()

local Window = Rayfield:CreateWindow({
	Name = "RBXploit",
	LoadingTitle = "RBXploit",
	LoadingSubtitle = "just for fun ðŸ˜ˆ",

	KeySystem = true,
	KeySettings = {
		Title = "RBXploit - Key System",
		Subtitle = "Enter Key",
		Note = "Den Key findest du im Discord",
		SaveKey = false,
		Key = "ADMIN"
	},

	ToggleKey = Enum.KeyCode.RightShift
})

-- ================================ --
-- PLAYER TAB
-- ================================ --
local PlayerTab = Window:CreateTab("Player", 4483362458)
local SelectedPlayer

local function UpdatePlayerList()
	local list = {}
	for _,p in pairs(Players:GetPlayers()) do
		if p ~= LocalPlayer then table.insert(list,p.Name) end
	end
	return list
end

local PlayerDropdown = PlayerTab:CreateDropdown({
	Name="Select Player",
	Options=UpdatePlayerList(),
	Callback=function(v) SelectedPlayer=v[1] end
})
Players.PlayerAdded:Connect(function() PlayerDropdown:Set(UpdatePlayerList()) end)
Players.PlayerRemoving:Connect(function() PlayerDropdown:Set(UpdatePlayerList()) end)

PlayerTab:CreateButton({Name="Teleport to Player", Callback=function()
	local p=Players:FindFirstChild(SelectedPlayer)
	if p and p.Character and LocalPlayer.Character then
		LocalPlayer.Character.HumanoidRootPart.CFrame=p.Character.HumanoidRootPart.CFrame
	end
end})

PlayerTab:CreateToggle({Name="Spectate", Callback=function(v)
	local p=Players:FindFirstChild(SelectedPlayer)
	if v and p and p.Character then Camera.CameraSubject=p.Character.Humanoid
	else Camera.CameraSubject=LocalPlayer.Character.Humanoid end
end})

PlayerTab:CreateButton({Name="Rejoin Server", Callback=function()
	TeleportService:Teleport(game.PlaceId, LocalPlayer)
end})

PlayerTab:CreateButton({Name="Server Hop", Callback=function()
	local PlaceID = game.PlaceId
	local AllServers = {}
	-- Server Hop Logic (Executor-Ready)
	TeleportService:Teleport(PlaceID, LocalPlayer)
end})

PlayerTab:CreateButton({Name="PANIC (Disable All)", Callback=function()
	flying=false
	velocity=Vector3.zero
	noclip=false
	infJump=false
	bhop=false
	triggerbot=false
	aimEnabled=false
	AntiAFK=false
end})

-- ================================ --
-- MOVEMENT TAB (JUMP + SPEED + RESET)
-- ================================ --
local MovementTab = Window:CreateTab("Movement", 4483362458)

local noclip = false
local infJump = false
local bhop = false
local sprint = false
local gravityEnabled = true
local jumpInput = 50
local speedInput = 16

-- ============================= --
-- SAFE CHARACTER GET
-- ============================= --
local function getChar()
	local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	local hum = char:WaitForChild("Humanoid")
	local hrp = char:WaitForChild("HumanoidRootPart")
	return char, hum, hrp
end

-- ============================= --
-- WALK SPEED INPUT
-- ============================= --
MovementTab:CreateInput({
	Name = "âš¡ WalkSpeed",
	PlaceholderText = "16 - 500",
	RemoveTextAfterFocusLost = false,
	Callback = function(v)
		speedInput = tonumber(v) or speedInput
	end
})

MovementTab:CreateButton({
	Name = "âœ… Apply WalkSpeed",
	Callback = function()
		local _, hum = getChar()
		hum.WalkSpeed = math.clamp(speedInput, 16, 500)
	end
})

-- ============================= --
-- JUMP POWER INPUT
-- ============================= --
MovementTab:CreateInput({
	Name = "â¬† JumpPower",
	PlaceholderText = "50 - 90000",
	RemoveTextAfterFocusLost = false,
	Callback = function(v)
		jumpInput = tonumber(v) or jumpInput
	end
})

MovementTab:CreateButton({
	Name = "âœ… Apply JumpPower",
	Callback = function()
		local _, hum = getChar()
		hum.UseJumpPower = true
		hum.JumpPower = math.clamp(jumpInput, 50, 90000)
	end
})

-- ============================= --
-- TOGGLES
-- ============================= --
MovementTab:CreateToggle({
	Name = "Noclip",
	Callback = function(v)
		noclip = v
	end
})

MovementTab:CreateToggle({
	Name = "Infinite Jump",
	Callback = function(v)
		infJump = v
	end
})

MovementTab:CreateToggle({
	Name = "Bunny Hop",
	Callback = function(v)
		bhop = v
	end
})

MovementTab:CreateToggle({
	Name = "Sprint Mode",
	Callback = function(v)
		sprint = v
	end
})

MovementTab:CreateToggle({
	Name = "Gravity Toggle",
	Callback = function(v)
		gravityEnabled = v
	end
})

-- ============================= --
-- RESET BUTTON
-- ============================= --
MovementTab:CreateButton({
	Name = "â™» Reset Movement",
	Callback = function()
		local _, hum = getChar()
		hum.WalkSpeed = 16
		hum.UseJumpPower = true
		hum.JumpPower = 50
		noclip = false
		infJump = false
		bhop = false
		sprint = false
		gravityEnabled = true
	end
})

-- ============================= --
-- RUN LOOP
-- ============================= --
RunService.Stepped:Connect(function()
	local char, hum, hrp = getChar()

	-- Noclip
	if noclip then
		for _,p in pairs(char:GetChildren()) do
			if p:IsA("BasePart") then
				p.CanCollide = false
			end
		end
	end

	-- Bunny Hop
	if bhop and hum.FloorMaterial ~= Enum.Material.Air then
		hum:ChangeState(Enum.HumanoidStateType.Jumping)
	end

	-- Sprint Mode
	if sprint then
		hum.WalkSpeed = math.max(hum.WalkSpeed, speedInput * 1.5)
	end

	-- Gravity
	if not gravityEnabled then
		hrp.AssemblyLinearVelocity = Vector3.zero
	end
end)

-- ============================= --
-- INFINITE JUMP
-- ============================= --
UIS.JumpRequest:Connect(function()
	if infJump then
		local char, hum = getChar()
		hum:ChangeState(Enum.HumanoidStateType.Jumping)
	end
end)

-- ================================ --
-- FLY TAB
-- ================================ --
local FlyTab = Window:CreateTab("Fly", 4483362458)
local flying=false
local velocity=Vector3.zero
local maxSpeed=100
local accel=2
local drag=0.92
local hover=false
local brake=false
local bv,bg
local controls={W=false,A=false,S=false,D=false,Up=false,Down=false,Boost=false}
local afterburner=false

UIS.InputBegan:Connect(function(i,g)
	if g then return end
	if i.KeyCode==Enum.KeyCode.W then controls.W=true end
	if i.KeyCode==Enum.KeyCode.A then controls.A=true end
	if i.KeyCode==Enum.KeyCode.S then controls.S=true end
	if i.KeyCode==Enum.KeyCode.D then controls.D=true end
	if i.KeyCode==Enum.KeyCode.Space then controls.Up=true end
	if i.KeyCode==Enum.KeyCode.LeftControl then controls.Down=true end
	if i.KeyCode==Enum.KeyCode.LeftShift then controls.Boost=true end
	if i.KeyCode==Enum.KeyCode.H then hover=not hover end
	if i.KeyCode==Enum.KeyCode.X then brake=true end
	if i.KeyCode==Enum.KeyCode.B then afterburner=true end
end)
UIS.InputEnded:Connect(function(i)
	if i.KeyCode==Enum.KeyCode.W then controls.W=false end
	if i.KeyCode==Enum.KeyCode.A then controls.A=false end
	if i.KeyCode==Enum.KeyCode.S then controls.S=false end
	if i.KeyCode==Enum.KeyCode.D then controls.D=false end
	if i.KeyCode==Enum.KeyCode.Space then controls.Up=false end
	if i.KeyCode==Enum.KeyCode.LeftControl then controls.Down=false end
	if i.KeyCode==Enum.KeyCode.LeftShift then controls.Boost=false end
	if i.KeyCode==Enum.KeyCode.X then brake=false end
	if i.KeyCode==Enum.KeyCode.B then afterburner=false end
end)

FlyTab:CreateToggle({Name="Advanced Fly", Callback=function(state)
	flying=state
	local char=LocalPlayer.Character
	if not char then return end
	local hrp=char:WaitForChild("HumanoidRootPart")
	local hum=char:WaitForChild("Humanoid")

	if state then
		hum.PlatformStand=true
		bv=Instance.new("BodyVelocity",hrp)
		bv.MaxForce=Vector3.new(1e9,1e9,1e9)
		bg=Instance.new("BodyGyro",hrp)
		bg.MaxTorque=Vector3.new(1e9,1e9,1e9)
		bg.P=10000

		RunService:BindToRenderStep("FlyLoop",200,function()
			if not flying then return end
			local dir=Vector3.zero
			if controls.W then dir+=Camera.CFrame.LookVector end
			if controls.S then dir-=Camera.CFrame.LookVector end
			if controls.A then dir-=Camera.CFrame.RightVector end
			if controls.D then dir+=Camera.CFrame.RightVector end
			if controls.Up then dir+=Vector3.new(0,1,0) end
			if controls.Down then dir-=Vector3.new(0,1,0) end

			local boost = (controls.Boost or afterburner) and 2 or 1

			if hover then velocity=Vector3.zero
			elseif brake then velocity*=0.7
			elseif dir.Magnitude>0 then velocity+=dir.Unit*accel*boost
			end

			velocity*=drag
			if velocity.Magnitude>maxSpeed*boost then velocity=velocity.Unit*maxSpeed*boost end
			bv.Velocity=velocity
			bg.CFrame=Camera.CFrame
		end)
	else
		RunService:UnbindFromRenderStep("FlyLoop")
		hum.PlatformStand=false
		velocity=Vector3.zero
		if bv then bv:Destroy() end
		if bg then bg:Destroy() end
	end
end})

FlyTab:CreateSlider({Name="Fly Max Speed", Range={30,300}, CurrentValue=maxSpeed, Callback=function(v) maxSpeed=v end})
FlyTab:CreateSlider({Name="Fly Acceleration", Range={1,10}, CurrentValue=accel, Callback=function(v) accel=v end})
FlyTab:CreateSlider({Name="Fly Drag", Range={0.85,0.99}, CurrentValue=drag, Callback=function(v) drag=v end})
FlyTab:CreateButton({Name="Preset Slow", Callback=function() maxSpeed=50;accel=1.5;drag=0.95 end})
FlyTab:CreateButton({Name="Preset Fast", Callback=function() maxSpeed=150;accel=3;drag=0.9 end})
FlyTab:CreateButton({Name="Preset Insane", Callback=function() maxSpeed=300;accel=6;drag=0.88 end})

-- ================================ --
-- COMBAT TAB
-- ================================ --
local CombatTab = Window:CreateTab("Combat",4483362458)
local aimEnabled=false
local AimFOV=120
local AimSmoothness=0.15
local AimTargetPart="Head"
local triggerbot=false

CombatTab:CreateToggle({Name="Aim Assist", Callback=function(v) aimEnabled=v end})
CombatTab:CreateSlider({Name="Aim FOV", Range={50,300}, CurrentValue=AimFOV, Callback=function(v) AimFOV=v end})
CombatTab:CreateSlider({Name="Aim Smoothness", Range={0.05,0.5}, CurrentValue=AimSmoothness, Callback=function(v) AimSmoothness=v end})
CombatTab:CreateToggle({Name="Triggerbot", Callback=function(v) triggerbot=v end})

RunService.RenderStepped:Connect(function()
	-- Aim Assist
	if aimEnabled and UIS:IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
		local closest=nil; local dist=math.huge
		for _,p in pairs(Players:GetPlayers()) do
			if p~=LocalPlayer and p.Character and p.Character:FindFirstChild(AimTargetPart) then
				local hum=p.Character:FindFirstChild("Humanoid")
				if hum and hum.Health>0 and p.Team~=LocalPlayer.Team then
					local pos,onscreen=Camera:WorldToViewportPoint(p.Character[AimTargetPart].Position)
					if onscreen then
						local mpos=Vector2.new(UIS:GetMouseLocation().X,UIS:GetMouseLocation().Y)
						local d=(Vector2.new(pos.X,pos.Y)-mpos).Magnitude
						if d<AimFOV and d<dist then
							dist=d
							closest=p.Character[AimTargetPart]
						end
					end
				end
			end
		end
		if closest then
			Camera.CFrame=Camera.CFrame:Lerp(CFrame.new(Camera.CFrame.Position,closest.Position),AimSmoothness)
		end
	end
	-- Triggerbot
	if triggerbot and UIS:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) then
		local target=Camera:FindPartOnRayWithIgnoreList(Ray.new(Camera.CFrame.Position, Camera.CFrame.LookVector*1000), {LocalPlayer.Character})
		if target and target.Parent:FindFirstChild("Humanoid") then
			mouse1click()
		end
	end
end)

-- ================================ --
-- VISUALS TAB
-- ================================ --
local VisualTab = Window:CreateTab("Visuals",4483362458)
local esp=false
VisualTab:CreateToggle({Name="ESP", Callback=function(v) esp=v end})
VisualTab:CreateButton({Name="Apply Chams", Callback=function()
	for _,p in pairs(Players:GetPlayers()) do
		if p~=LocalPlayer and p.Character then
			for _,part in pairs(p.Character:GetChildren()) do
				if part:IsA("BasePart") then
					part.Material=Enum.Material.ForceField
					part.Color=Color3.fromRGB(255,0,0)
				end
			end
		end
	end
end})
VisualTab:CreateButton({Name="Fullbright", Callback=function()
	Lighting.Brightness=5
	Lighting.ClockTime=14
	Lighting.FogEnd=100000
end})

-- ================================ --
-- UTILITY TAB
-- ================================ --
local UtilityTab = Window:CreateTab("Utility",4483362458)
local AntiAFK=false
UtilityTab:CreateToggle({Name="Anti AFK", CurrentValue=false, Callback=function(v) AntiAFK=v end})

LocalPlayer.Idled:Connect(function()
	if AntiAFK then
		VirtualUser:Button2Down(Vector2.new(0,0),Camera.CFrame)
		task.wait(0.5)
		VirtualUser:Button2Up(Vector2.new(0,0),Camera.CFrame)
	end
end)

task.spawn(function()
	while true do
		task.wait(30)
		if AntiAFK then
			VirtualUser:MoveMouseRelative(5,0)
			task.wait(0.1)
			VirtualUser:MoveMouseRelative(-5,0)
			local char=LocalPlayer.Character
			if char and char:FindFirstChild("Humanoid") then
				char.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
			end
		end
	end
end)

-- ================================ --
Rayfield:Notify({Title="Executor Mega Admin", Content="All Features Loaded!", Duration=5})
